# 如何测试 Web Excel Agent

## 最快的方式：3步体验

### 第1步：启动应用

```bash
# 终端1 - 启动后端
cd backend
pip install -r requirements.txt
uvicorn app.main:app --reload

# 终端2 - 启动前端
cd frontend
npm install
npm run dev
```

### 第2步：打开浏览器

访问：**http://localhost:3000**

### 第3步：输入命令

在AI对话框中输入：

```
demo
```

**就这么简单！** 你会立即看到：
- ✅ 包含6个月销售数据的表格
- ✅ 可以直接编辑
- ✅ 可以创建图表
- ✅ 可以导出Excel

---

## 测试场景

### 场景1：纯Demo测试（推荐新手）

**目的**：快速体验所有功能

**步骤**：

1. 输入 `demo`
2. 点击单元格修改数据
3. 点击"导出Excel"按钮
4. 输入 `创建柱状图`

**预期结果**：
- 表格显示6个月的销售数据
- 修改后的数据立即生效
- 浏览器下载Excel文件
- 右侧显示图表

---

### 场景2：网页抓取测试

**目的**：测试真实数据抓取

**步骤**：

1. 输入 `帮我抓取 https://www.w3schools.com/html/html_tables.asp 的第一个表格`
2. 等待数据加载
3. 查看抓取的数据

**预期结果**：
- 显示Company, Contact, Country等列
- 数据完整无缺失

**如果失败**：使用 `demo` 命令作为备选

---

### 场景3：完整工作流测试

**目的**：测试完整的Excel工作流

**步骤**：

1. **生成数据**
   ```
   demo
   ```

2. **编辑数据**
   - 点击"一月"的"销售额"单元格
   - 修改为 `65000`

3. **添加行**
   - 点击"+行"按钮
   - 在新行输入数据

4. **创建图表**
   ```
   创建折线图
   ```

5. **导出文件**
   - 点击"导出Excel"
   - 打开下载的文件验证

**预期结果**：
- 所有操作流畅无卡顿
- 数据正确保存
- 导出的Excel格式正确

---

## 可用的测试命令

| 输入 | 功能 |
|------|------|
| `demo` | 生成演示数据 |
| `演示数据` | 同上（中文） |
| `抓取 [URL]` | 抓取网页表格 |
| `创建柱状图` | 创建柱状图 |
| `创建折线图` | 创建折线图 |
| `创建饼图` | 创建饼图 |
| `帮助` | 显示帮助信息 |

---

## 推荐的测试网页（可选）

如果想测试真实网页抓取：

### 简单网页
```
https://www.w3schools.com/html/html_tables.asp
```

### 中文网页（可能需要多次尝试）
```
https://baike.baidu.com
```

**注意**：如果抓取失败是正常的，使用 `demo` 即可完整体验！

---

## 功能检查清单

运行这个清单测试所有功能：

- [ ] **数据生成**
  ```
  输入: demo
  检查: 表格是否显示6行数据
  ```

- [ ] **单元格编辑**
  ```
  操作: 点击单元格并修改
  检查: 修改是否立即生效
  ```

- [ ] **添加行**
  ```
  操作: 点击"+行"按钮
  检查: 是否添加了新行
  ```

- [ ] **添加列**
  ```
  操作: 点击"+列"按钮
  检查: 是否添加了新列
  ```

- [ ] **导出Excel**
  ```
  操作: 点击"导出Excel"
  检查: 是否下载了.xlsx文件
  ```

- [ ] **柱状图**
  ```
  输入: 创建柱状图
  检查: 右侧是否显示图表
  ```

- [ ] **折线图**
  ```
  输入: 创建折线图
  检查: 图表类型是否改变
  ```

---

## 常见问题

### Q: demo命令没反应？

**检查**：
```bash
# 后端是否运行
curl http://localhost:8000/health

# 应该返回: {"status":"healthy"}
```

### Q: 抓取网页失败？

**正常现象！** 解决方法：
```
输入: demo
```

Demo数据提供了完整的测试场景。

### Q: 图表不显示？

**原因**：数据格式不正确

**解决**：
1. 确保使用demo数据
2. 确保表格有数值列

### Q: 导出的Excel打不开？

**检查**：
- 使用Excel 2016+或WPS打开
- 文件扩展名应该是.xlsx

---

## 测试技巧

### 技巧1：快速重置

随时输入 `demo` 重新生成数据

### 技巧2：测试大表格

在demo数据基础上：
1. 点击"+行"10次
2. 填充数据
3. 测试性能

### 技巧3：测试特殊字符

在单元格中输入：
```
中文测试
日本語テスト
$100.50
2024-01-01
```

### 技巧4：测试导出质量

1. 生成demo数据
2. 修改部分单元格
3. 导出Excel
4. 用Excel打开验证数据完整性

---

## 更多帮助

| 文档 | 用途 |
|------|------|
| `QUICK_TEST.md` | 快速测试指南 |
| `TEST_URLS.md` | 测试URL参考 |
| `TESTING_GUIDE.md` | 完整测试指南 |
| `README.md` | 项目说明 |

---

## 开始测试

**现在就试试吧！**

1. 启动应用
2. 打开 http://localhost:3000
3. 输入：`demo`

**3步完成，无需任何外部依赖！** 🎉
