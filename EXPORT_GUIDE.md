# 📊 Excel导出图表功能使用指南

## ✅ 功能说明

导出Excel时，会自动包含右侧显示的所有图表（柱状图、折线图、饼图等）。

## 🎯 使用步骤

### 1. 生成数据
```
在对话框输入: demo
```
✅ 生成包含6个月销售数据的表格

### 2. 创建图表（可创建多个）
```
输入: 创建柱状图
输入: 创建折线图
输入: 创建饼图
```
✅ 图表会显示在右侧面板
✅ 导出按钮会显示图表数量：`导出 Excel (3个图表)`

### 3. 编辑表格（可选）
- 点击单元格修改数据
- 点击"+行"添加新行
- 点击"+列"添加新列
✅ 修改后的数据会包含在导出的Excel中

### 4. 导出Excel
```
点击"导出 Excel"按钮
```
✅ 浏览器会下载 `excel_export.xlsx` 文件
✅ 文件包含：
  - 最新的表格数据
  - 所有创建的图表
  - 图表引用Excel数据，支持动态更新

## 🔍 验证方法

### 方法1：打开Excel文件
1. 用Excel/WPS打开下载的文件
2. 检查右侧是否有图表
3. 修改表格数据，图表应该自动更新

### 方法2：查看浏览器控制台
1. 按F12打开开发者工具
2. 切换到Console标签
3. 点击"导出Excel"
4. 查看导出日志：
```
=== 开始导出Excel ===
📊 Workbook ID: xxx
📊 Charts数量: 3
📊 Charts数据: [...]
📤 步骤1: 同步表格数据到后端...
✅ 表格数据同步完成
📤 步骤2: 发送3个图表到后端...
✅ 图表发送完成
📤 步骤3: 导出Excel文件...
✅ Excel文件生成完成
=== 导出完成 ===
✅ 成功导出包含 3 个图表的Excel文件
```

## ⚠️ 常见问题

### Q: 为什么导出的Excel没有图表？
**A:** 检查以下几点：
1. 右侧是否显示了图表？
2. 导出按钮是否显示图表数量？
3. 浏览器控制台是否有错误？

### Q: 图表数据不正确？
**A:** 图表使用的是默认的演示数据。可以：
1. 修改表格数据后重新创建图表
2. 或在Excel中修改数据，图表会自动更新

### Q: 可以只导出表格不导出图表吗？
**A:** 可以。只要不创建图表（或刷新页面清空图表），导出的Excel就只包含表格数据。

## 🎨 支持的图表类型

| 类型 | 命令 | 说明 |
|------|------|------|
| 柱状图 | `创建柱状图` | 适合比较数据大小 |
| 折线图 | `创建折线图` | 适合显示趋势变化 |
| 饼图 | `创建饼图` | 适合显示占比关系 |

## 📝 注意事项

1. **数据同步**: 导出时会先同步最新的表格数据，确保导出的是当前显示的内容
2. **图表数量**: 可以创建多个图表，导出时会全部包含
3. **文件大小**: 图表会增加文件大小，但通常不会超过1MB
4. **兼容性**: 导出的Excel文件兼容Excel 2007+、WPS等

## 🚀 高级用法

### 修改表格后保持图表
1. 生成demo数据
2. 创建图表
3. 修改表格数据（如修改销售额）
4. 导出Excel → 图表会引用修改后的数据

### 批量导出多个图表
```
demo
创建柱状图
创建折线图
创建饼图
[点击导出]
```
✅ 一次导出包含3个图表的Excel文件

---

**提示**: 如果遇到问题，请检查浏览器控制台的日志信息，或查看后端服务器的输出。
